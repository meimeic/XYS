<?xml version="1.0" encoding="utf-8"?>
<Report ScriptLanguage="CSharp" ReferencedAssemblies="System.dll&#13;&#10;System.Drawing.dll&#13;&#10;System.Windows.Forms.dll&#13;&#10;System.Data.dll&#13;&#10;System.Xml.dll&#13;&#10;mscorlib.dll" ReportInfo.Created="08/13/2015 15:10:27" ReportInfo.Modified="08/13/2016 21:32:14" ReportInfo.CreatorVersion="2015.3.4.0">
  <ScriptText>using System;
using System.Collections;
using System.Collections.Generic;
using System.ComponentModel;
using System.Windows.Forms;
using System.Drawing;
using System.Data;
using FastReport;
using FastReport.Data;
using FastReport.Dialog;
using FastReport.Barcode;
using FastReport.Table;
using FastReport.Utils;

namespace FastReport
{
  public class ReportScript
  {
    private void Table1_ManualBuild(object sender, EventArgs e)
    {
      TableDataSource  ItemTable = Report.GetDataSource(&quot;ReportItem&quot;) as TableDataSource;
       Report.GetParameter(&quot;RowNum&quot;).Value=1;
      ItemTable.Init();
      //Row1.Height=(float)(Units.Centimeters*0.5);
      //Table1.PrintRow(0);
      //Table1.PrintColumns();
      while(ItemTable.HasMoreRows)
      {
        string refRange=(string)Report.GetColumnValue(&quot;ReportItem.RefRange&quot;);
        int i=(refRange.Length)/14+1;
        Row1.Height=(float)(Units.Centimeters*0.45*i);
        Table1.PrintRow(0);
        Table1.PrintColumns();
        Report.GetParameter(&quot;RowNum&quot;).Value=(int)Report.GetParameter(&quot;RowNum&quot;).Value+1;
        ItemTable.Next(); 
      }
    }
  }
}
</ScriptText>
  <Dictionary>
    <TableDataSource Name="ReportForm" ReferenceName="Data.ReportForm" DataType="System.Int32" Enabled="true">
      <Column Name="ReceiveDate" DataType="System.DateTime" PropName="Column"/>
      <Column Name="SectionNo" DataType="System.Int32" PropName="Column"/>
      <Column Name="TestTypeNo" DataType="System.Int32" PropName="Column"/>
      <Column Name="SampleNo" DataType="System.String" PropName="Column"/>
      <Column Name="SerialNo" DataType="System.String" PropName="Column"/>
      <Column Name="DeptName" DataType="System.String" PropName="Column"/>
      <Column Name="BedNo" DataType="System.String" PropName="Column"/>
      <Column Name="CName" DataType="System.String" PropName="Column"/>
      <Column Name="Sex" DataType="System.String" PropName="Column"/>
      <Column Name="Age" DataType="System.String" PropName="Column"/>
      <Column Name="PID" DataType="System.String" PropName="Column"/>
      <Column Name="SampleTypeName" DataType="System.String" PropName="Column"/>
      <Column Name="ClinicTypeName" DataType="System.String" PropName="Column"/>
      <Column Name="DoctorName" DataType="System.String" PropName="Column"/>
      <Column Name="ClinicalDiagnosis" DataType="System.String" PropName="Column"/>
      <Column Name="Explanation" DataType="System.String" PropName="Column"/>
      <Column Name="ParItemName" DataType="System.String" PropName="Column"/>
      <Column Name="TestDateTime" DataType="System.String" PropName="Column"/>
      <Column Name="CollectDateTime" DataType="System.String" PropName="Column"/>
      <Column Name="InceptDateTime" DataType="System.String" PropName="Column"/>
      <Column Name="ReportDateTime" DataType="System.String" PropName="Column"/>
      <Column Name="ReportTitle" DataType="System.String" PropName="Column"/>
      <Column Name="Remark" DataType="System.String" PropName="Column"/>
      <Column Name="TechnicianImage" DataType="System.Byte[]" PropName="Column"/>
      <Column Name="CheckerImage" DataType="System.Byte[]" PropName="Column"/>
      <Column Name="FormMemo" DataType="System.String" PropName="Column"/>
      <Column Name="FormComment" DataType="System.String" PropName="Column"/>
      <Column Name="FormComment2" DataType="System.String" PropName="Column"/>
    </TableDataSource>
    <TableDataSource Name="ReportItem" ReferenceName="Data.ReportItem" DataType="System.Int32" Enabled="true">
      <Column Name="ReceiveDate" DataType="System.DateTime" PropName="Column"/>
      <Column Name="SectionNo" DataType="System.Int32" PropName="Column"/>
      <Column Name="TestTypeNo" DataType="System.Int32" PropName="Column"/>
      <Column Name="SampleNo" DataType="System.String" PropName="Column"/>
      <Column Name="ItemNo" DataType="System.String" PropName="Column"/>
      <Column Name="DispNo" DataType="System.Int32" PropName="Column"/>
      <Column Name="ItemName" DataType="System.String" PropName="Column"/>
      <Column Name="ItemEName" DataType="System.String" PropName="Column"/>
      <Column Name="ItemResult" DataType="System.String" PropName="Column"/>
      <Column Name="ResultStatus" DataType="System.String" PropName="Column"/>
      <Column Name="ItemUnit" DataType="System.String" PropName="Column"/>
      <Column Name="RefRange" DataType="System.String" PropName="Column"/>
    </TableDataSource>
    <TableDataSource Name="ManReportItem" ReferenceName="Data.ManReportItem" DataType="System.Int32" Enabled="true">
      <Column Name="ReceiveDate" DataType="System.DateTime" PropName="Column"/>
      <Column Name="SectionNo" DataType="System.Int32" PropName="Column"/>
      <Column Name="TestTypeNo" DataType="System.Int32" PropName="Column"/>
      <Column Name="SampleNo" DataType="System.String" PropName="Column"/>
      <Column Name="Item9288" DataType="System.String" PropName="Column"/>
      <Column Name="Item9289" DataType="System.String" PropName="Column"/>
      <Column Name="Item9290" DataType="System.String" PropName="Column"/>
      <Column Name="Item9291" DataType="System.String" PropName="Column"/>
      <Column Name="Item9292" DataType="System.String" PropName="Column"/>
      <Column Name="Item9293" DataType="System.String" PropName="Column"/>
      <Column Name="Item9294" DataType="System.String" PropName="Column"/>
      <Column Name="Item9300" DataType="System.String" PropName="Column"/>
      <Column Name="Item9295" DataType="System.String" PropName="Column"/>
      <Column Name="Item9296" DataType="System.String" PropName="Column"/>
      <Column Name="Item9297" DataType="System.String" PropName="Column"/>
      <Column Name="Item9301" DataType="System.String" PropName="Column"/>
      <Column Name="Remark" DataType="System.String" PropName="Column"/>
    </TableDataSource>
    <TableDataSource Name="RanReportItem" ReferenceName="Data.RanReportItem" DataType="System.Int32" Enabled="true">
      <Column Name="ReceiveDate" DataType="System.DateTime" PropName="Column"/>
      <Column Name="SectionNo" DataType="System.Int32" PropName="Column"/>
      <Column Name="TestTypeNo" DataType="System.Int32" PropName="Column"/>
      <Column Name="SampleNo" DataType="System.String" PropName="Column"/>
      <Column Name="SampleQuality" DataType="System.String" PropName="Column"/>
      <Column Name="CulturalMethod" DataType="System.String" PropName="Column"/>
      <Column Name="BandMethod" DataType="System.String" PropName="Column"/>
      <Column Name="CaryogramDesc" DataType="System.String" PropName="Column"/>
      <Column Name="Remark" DataType="System.String" PropName="Column"/>
    </TableDataSource>
    <TableDataSource Name="HLAReportItem" ReferenceName="Data.HLAReportItem" DataType="System.Int32" Enabled="true">
      <Column Name="ReceiveDate" DataType="System.DateTime" PropName="Column"/>
      <Column Name="SectionNo" DataType="System.Int32" PropName="Column"/>
      <Column Name="TestTypeNo" DataType="System.Int32" PropName="Column"/>
      <Column Name="SampleNo" DataType="System.String" PropName="Column"/>
      <Column Name="OtherName" DataType="System.String" PropName="Column"/>
      <Column Name="OtherAge" DataType="System.String" PropName="Column"/>
      <Column Name="OtherRelation" DataType="System.String" PropName="Column"/>
      <Column Name="HLAItemName" DataType="System.String" PropName="Column"/>
      <Column Name="HLAValue1" DataType="System.String" PropName="Column"/>
      <Column Name="HLAValue2" DataType="System.String" PropName="Column"/>
      <Column Name="Remark" DataType="System.String" PropName="Column"/>
    </TableDataSource>
    <TableDataSource Name="RFGraphData" ReferenceName="Data.RFGraphData" DataType="System.Int32" Enabled="true">
      <Column Name="ReceiveDate" DataType="System.DateTime" PropName="Column"/>
      <Column Name="SectionNo" DataType="System.Int32" PropName="Column"/>
      <Column Name="TestTypeNo" DataType="System.Int32" PropName="Column"/>
      <Column Name="SampleNo" DataType="System.String" PropName="Column"/>
      <Column Name="S_FLHxS" DataType="System.Byte[]" PropName="Column"/>
      <Column Name="S_FLLxS" DataType="System.Byte[]" PropName="Column"/>
      <Column Name="S_SSCxS" DataType="System.Byte[]" PropName="Column"/>
      <Column Name="B_FLHxB1" DataType="System.Byte[]" PropName="Column"/>
      <Column Name="S_FSCWxS" DataType="System.Byte[]" PropName="Column"/>
      <Column Name="S_FLLWxS" DataType="System.Byte[]" PropName="Column"/>
      <Column Name="YiChuan_Result" DataType="System.Byte[]" PropName="Column"/>
      <Column Name="FISH_Normal" DataType="System.Byte[]" PropName="Column"/>
    </TableDataSource>
    <Relation Name="ReportForm_ReportItem" ParentDataSource="ReportForm" ChildDataSource="ReportItem" ParentColumns="ReceiveDate&#13;&#10;SectionNo&#13;&#10;TestTypeNo&#13;&#10;SampleNo" ChildColumns="ReceiveDate&#13;&#10;SectionNo&#13;&#10;TestTypeNo&#13;&#10;SampleNo" Enabled="true"/>
    <Relation Name="ReportForm_ManReportItem" ParentDataSource="ReportForm" ChildDataSource="ManReportItem" ParentColumns="ReceiveDate&#13;&#10;SectionNo&#13;&#10;TestTypeNo&#13;&#10;SampleNo" ChildColumns="ReceiveDate&#13;&#10;SectionNo&#13;&#10;TestTypeNo&#13;&#10;SampleNo" Enabled="true"/>
    <Relation Name="ReportForm_RFGraphData" ParentDataSource="ReportForm" ChildDataSource="RFGraphData" ParentColumns="ReceiveDate&#13;&#10;SectionNo&#13;&#10;TestTypeNo&#13;&#10;SampleNo" ChildColumns="ReceiveDate&#13;&#10;SectionNo&#13;&#10;TestTypeNo&#13;&#10;SampleNo" Enabled="true"/>
    <Parameter Name="RowNum" DataType="System.Int32"/>
  </Dictionary>
  <ReportPage Name="Page1" PaperWidth="195" PaperHeight="271" RawPaperSize="166" LeftMargin="20" BottomMargin="5" FirstPageSource="15" OtherPagesSource="15">
    <DataBand Name="Data1" Top="51.25" Width="623.7" Height="56.7" DataSource="ReportForm" KeepTogether="true" KeepDetail="true">
      <TextObject Name="Text4" Width="68.04" Height="17.01" Text="申请序号：" Padding="0, 0, 0, 0" WordWrap="false" Font="宋体, 10pt"/>
      <TextObject Name="Text5" Left="66.15" Width="105.84" Height="17.01" Text="[ReportForm.SerialNo]" Font="宋体, 10pt"/>
      <TextObject Name="Text6" Left="170.1" Width="41.58" Height="17.01" Text="科室：" WordWrap="false" Font="宋体, 10pt"/>
      <TextObject Name="Text7" Left="209.79" Width="158.76" Height="17.01" Text="[ReportForm.DeptName]" Font="宋体, 10pt"/>
      <TextObject Name="Text8" Left="366.66" Width="41.58" Height="17.01" Text="床号：" WordWrap="false" Font="宋体, 10pt"/>
      <TextObject Name="Text9" Left="406.35" Width="49.14" Height="17.01" Text="[ReportForm.BedNo]" Font="宋体, 10pt"/>
      <TextObject Name="Text10" Left="453.6" Width="64.26" Height="17.01" Text="样本编号：" WordWrap="false" Font="宋体, 10pt"/>
      <TextObject Name="Text11" Left="519.75" Width="79.38" Height="17.01" Text="[ReportForm.SampleNo]" Font="宋体, 10pt"/>
      <TextObject Name="Text12" Top="18.9" Width="41.58" Height="17.01" Text="姓名：" WordWrap="false" Font="宋体, 10pt"/>
      <TextObject Name="Text13" Left="37.8" Top="18.9" Width="83.16" Height="17.01" Text="[ReportForm.CName]" Font="宋体, 10pt"/>
      <TextObject Name="Text14" Left="132.3" Top="18.9" Width="41.58" Height="17.01" Text="性别：" WordWrap="false" Font="宋体, 10pt"/>
      <TextObject Name="Text15" Left="170.1" Top="18.9" Width="41.58" Height="17.01" Text="[ReportForm.Sex]" Font="宋体, 10pt"/>
      <TextObject Name="Text16" Left="226.8" Top="18.9" Width="41.58" Height="17.01" Text="年龄：" WordWrap="false" Font="宋体, 10pt"/>
      <TextObject Name="Text17" Left="264.6" Top="18.9" Width="41.58" Height="17.01" Text="[ReportForm.Age]" Font="宋体, 10pt"/>
      <TextObject Name="Text18" Left="321.3" Top="18.9" Width="56.7" Height="17.01" Text="病案号：" WordWrap="false" Font="宋体, 10pt"/>
      <TextObject Name="Text19" Left="378" Top="18.9" Width="56.7" Height="17.01" Text="[ReportForm.PID]" Font="宋体, 10pt"/>
      <TextObject Name="Text20" Left="453.6" Top="18.9" Width="64.26" Height="17.01" Text="样本类型：" WordWrap="false" Font="宋体, 10pt"/>
      <TextObject Name="Text21" Left="519.75" Top="18.9" Width="79.38" Height="17.01" Text="[ReportForm.SampleTypeName]" Font="宋体, 10pt"/>
      <TextObject Name="Text22" Top="37.8" Width="41.58" Height="17.01" Text="类型：" WordWrap="false" Font="宋体, 9pt"/>
      <TextObject Name="Text23" Left="37.8" Top="37.8" Width="49.14" Height="17.01" Text="[ReportForm.ClinicTypeName]" Font="宋体, 9pt"/>
      <TextObject Name="Text24" Left="103.95" Top="37.8" Width="41.58" Height="17.01" Text="医生：" WordWrap="false" Font="宋体, 9pt"/>
      <TextObject Name="Text25" Left="141.75" Top="37.8" Width="69.93" Height="17.01" Text="[ReportForm.DoctorName]" Font="宋体, 9pt"/>
      <TextObject Name="Text26" Left="226.8" Top="37.8" Width="66.15" Height="17.01" Text="临床诊断：" WordWrap="false" Font="宋体, 9pt"/>
      <TextObject Name="Text27" Left="283.5" Top="37.8" Width="162.54" Height="17.01" Text="[ReportForm.ClinicalDiagnosis]" Font="宋体, 9pt"/>
      <TextObject Name="Text28" Left="453.6" Top="37.8" Width="41.58" Height="17.01" Text="说明：" WordWrap="false" Font="宋体, 9pt"/>
      <TextObject Name="Text29" Left="491.4" Top="37.8" Width="137.97" Height="17.01" Text="[ReportForm.Explanation]" Font="宋体, 9pt"/>
      <DataHeaderBand Name="DataHeader1" Width="623.7" Height="47.25" KeepWithData="true" RepeatOnEveryPage="true">
        <TextObject Name="Text1" Top="18.9" Width="661.5" Height="18.9" Text="中国医学科学院血液病医院临床免疫室报告单" HorzAlign="Center" Font="宋体, 14pt, style=Bold"/>
        <TextObject Name="Text2" Left="-9.45" Width="526.93" Height="16.63" Text="[ReportForm.ParItemName]" Padding="0, 0, 0, 0" Font="宋体, 8pt"/>
        <TextObject Name="Text3" Left="548.1" Width="135.32" Height="16.63" Text="[ReportForm.TestDateTime]" Format="Date" Format.Format="d" Font="宋体, 8pt"/>
      </DataHeaderBand>
      <DataBand Name="Data2" Top="134.85" Width="623.7" Height="28.35" KeepTogether="true" KeepDetail="true">
        <TableObject Name="Table1" Width="623.71" Height="23.61" ManualBuildEvent="Table1_ManualBuild">
          <TableColumn Name="Column1" Width="46.14"/>
          <TableColumn Name="Column2" Width="187.87"/>
          <TableColumn Name="Column3" Width="112.28"/>
          <TableColumn Name="Column4" Width="74.46"/>
          <TableColumn Name="Column5" Width="36.68"/>
          <TableColumn Name="Column6" Width="55.58"/>
          <TableColumn Name="Column7" Width="110.7"/>
          <TableRow Name="Row1" Height="23.61">
            <TableCell Name="Cell15" Text="[RowNum]" Padding="2, 3, 2, 1" WordWrap="false" Font="宋体, 10pt"/>
            <TableCell Name="Cell16" Text="[ReportItem.ItemName]" Padding="2, 3, 2, 1" WordWrap="false" Font="宋体, 10pt"/>
            <TableCell Name="Cell17" Text="[ReportItem.ItemEName]" Padding="2, 3, 2, 1" WordWrap="false" Font="宋体, 10pt"/>
            <TableCell Name="Cell18" Text="[ReportItem.ItemResult]" Padding="2, 3, 2, 1" WordWrap="false" Font="宋体, 10pt"/>
            <TableCell Name="Cell19" Text="[ReportItem.ResultStatus]" Padding="2, 3, 2, 1" WordWrap="false" Font="宋体, 10pt"/>
            <TableCell Name="Cell20" Text="[ReportItem.ItemUnit]" Padding="2, 3, 2, 1" Font="宋体, 10pt"/>
            <TableCell Name="Cell21" Text="[ReportItem.RefRange]" Padding="2, 3, 2, 1" Font="宋体, 10pt"/>
          </TableRow>
        </TableObject>
        <DataHeaderBand Name="DataHeader2" Top="111.95" Width="623.7" Height="18.9" Border.Lines="Top, Bottom">
          <TextObject Name="Text30" Width="35.91" Height="18.9" Text="序号" VertAlign="Center" Font="宋体, 10pt"/>
          <TextObject Name="Text31" Left="37.8" Width="204.12" Height="18.9" Text="  中文名称" VertAlign="Center" Font="宋体, 10pt"/>
          <TextObject Name="Text32" Left="349.65" Width="58.59" Height="18.9" Text="结果" VertAlign="Center" Font="宋体, 10pt"/>
          <TextObject Name="Text33" Left="406.35" Width="47.25" Height="18.9" Text="状态" VertAlign="Center" Font="宋体, 10pt"/>
          <TextObject Name="Text34" Left="453.6" Width="56.7" Height="18.9" Text="单位" VertAlign="Center" Font="宋体, 10pt"/>
          <TextObject Name="Text35" Left="510.3" Width="113.4" Height="18.9" Text="生物参考区间" VertAlign="Center" Font="宋体, 10pt"/>
          <TextObject Name="Text36" Left="236.25" Width="94.5" Height="18.9" Text="英文名称" VertAlign="Center" Font="宋体, 10pt"/>
        </DataHeaderBand>
        <Sort>
          <Sort Expression="[ReportItem.DispNo]"/>
        </Sort>
      </DataBand>
      <DataFooterBand Name="DataFooter1" Top="167.2" Width="623.7" Height="94.5" Border.Lines="Top, Bottom" PrintOnBottom="true" RepeatOnEveryPage="true">
        <TextObject Name="Text50" Width="47.25" Height="18.9" Text="备注:" VertAlign="Center" WordWrap="false" Font="宋体, 10pt, style=Bold"/>
        <TextObject Name="Text54" Left="47.25" Width="557.55" Height="18.9" Text="[ReportForm.FormMemo]" VertAlign="Center" Font="宋体, 10pt"/>
        <TextObject Name="Text42" Top="18.9" Width="64.26" Height="18.9" Text="采集时间：" VertAlign="Center" WordWrap="false" Font="宋体, 9pt"/>
        <TextObject Name="Text43" Top="37.8" Width="64.26" Height="18.9" Text="签收时间：" VertAlign="Center" WordWrap="false" Font="宋体, 9pt"/>
        <TextObject Name="Text44" Top="56.7" Width="64.26" Height="18.9" Text="报告时间：" VertAlign="Center" WordWrap="false" Font="宋体, 9pt"/>
        <TextObject Name="Text45" Left="56.7" Top="18.9" Width="132.3" Height="18.9" Text="[ReportForm.CollectDateTime]" Format="Date" Format.Format="f" VertAlign="Center" WordWrap="false" Font="宋体, 10pt"/>
        <TextObject Name="Text46" Left="56.7" Top="37.8" Width="132.3" Height="18.9" Text="[ReportForm.InceptDateTime]" Format="Date" Format.Format="f" VertAlign="Center" WordWrap="false" Font="宋体, 10pt"/>
        <TextObject Name="Text47" Left="56.7" Top="56.7" Width="132.3" Height="18.9" Text="[ReportForm.ReportDateTime]" Format="Date" Format.Format="f" VertAlign="Center" WordWrap="false" Font="宋体, 10pt"/>
        <TextObject Name="Text52" Left="340.2" Top="28.35" Width="56.7" Height="18.9" Text="检验者：" VertAlign="Center" WordWrap="false" Font="宋体, 10pt"/>
        <TextObject Name="Text53" Left="472.5" Top="28.35" Width="56.7" Height="18.9" Text="审核者：" VertAlign="Center" WordWrap="false" Font="宋体, 10pt"/>
        <TextObject Name="Text51" Top="75.6" Width="444.15" Height="15.12" Text="注:此报告仅对该份被检标本有效，若有质疑请在接到报告2天内提出！" VertAlign="Center" Font="宋体, 9pt"/>
        <TextObject Name="Text49" Left="529.2" Top="75.6" Width="94.5" Height="18.9" Text="第[Page#]页，共[TotalPages#]页" WordWrap="false" Font="宋体, 9pt"/>
      </DataFooterBand>
    </DataBand>
  </ReportPage>
</Report>
